# SendGrid éƒµä»¶é€šçŸ¥é…ç½®æŒ‡å—

## ğŸ“§ æ¦‚è¿°

RWA Hackathon ç¶²ç«™å·²å¯¦ç¾å®Œæ•´çš„éƒµä»¶é€šçŸ¥åŠŸèƒ½ï¼Œä½†éœ€è¦é…ç½® SendGrid æ‰èƒ½å¯¦éš›ç™¼é€éƒµä»¶ã€‚

## âœ… å·²å¯¦ç¾çš„éƒµä»¶é€šçŸ¥

1. **å‰µå»ºéœ€æ±‚æ™‚** â†’ ç™¼é€ç¢ºèªéƒµä»¶çµ¦éœ€æ±‚ç™¼å¸ƒè€…
2. **æ”¶åˆ°ç”³è«‹æ™‚** â†’ ç™¼é€é€šçŸ¥éƒµä»¶çµ¦éœ€æ±‚ç™¼å¸ƒè€…  
3. **æäº¤ç”³è«‹æ™‚** â†’ ç™¼é€ç¢ºèªéƒµä»¶çµ¦ç”³è«‹è€…
4. **ç”³è«‹ç‹€æ…‹è®Šæ›´** â†’ ç™¼é€æ›´æ–°éƒµä»¶çµ¦ç”³è«‹è€…

## ğŸš€ å¿«é€Ÿé…ç½®æ­¥é©Ÿ

### Step 1: è¨»å†Š SendGrid è³¬è™Ÿ

1. è¨ªå•ï¼šhttps://sendgrid.com/
2. é»æ“Š "Start for Free"
3. å¡«å¯«è¨»å†Šä¿¡æ¯
4. å…è²»è¨ˆåŠƒï¼šæ¯å¤© 100 å°éƒµä»¶ï¼ˆè¶³å¤ é»‘å®¢æ¾ä½¿ç”¨ï¼‰

### Step 2: å‰µå»º API Key

1. ç™»å…¥ SendGrid Dashboard
2. å·¦å´èœå–®ï¼š**Settings** > **API Keys**
3. é»æ“Š **Create API Key** æŒ‰éˆ•
4. API Key åç¨±ï¼š`RWA-Hackathon-Email`
5. æ¬Šé™é¸æ“‡ï¼š**Full Access** æˆ–è‡³å°‘ **Mail Send** > **Full Access**
6. é»æ“Š **Create & View**
7. **é‡è¦**ï¼šç«‹å³è¤‡è£½ API Keyï¼ˆåªé¡¯ç¤ºä¸€æ¬¡ï¼ï¼‰
   - æ ¼å¼ï¼š`SG.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`

### Step 3: é©—è­‰ç™¼ä»¶äººï¼ˆå¿…é ˆï¼ï¼‰

SendGrid è¦æ±‚é©—è­‰ç™¼ä»¶äººèº«ä»½ï¼Œå¦å‰‡éƒµä»¶æœƒè¢«æ‹’çµ•ã€‚

#### é¸é … A - å–®å€‹éƒµç®±é©—è­‰ï¼ˆå¿«é€Ÿï¼Œ5åˆ†é˜ï¼‰

1. å°èˆªåˆ°ï¼š**Settings** > **Sender Authentication**
2. é»æ“Š **Get Started** (Single Sender Verification å€åŸŸ)
3. å¡«å¯«ä¿¡æ¯ï¼š
   - From Name: `RWA Hackathon Taiwan`
   - From Email Address: `noreply@hackathon.com.tw`
   - Reply To: `support@hackathon.com.tw` æˆ–ç›¸åŒéƒµç®±
   - Company Address, City, State, Zip, Countryï¼ˆéš¨æ„å¡«å¯«ï¼‰
4. é»æ“Š **Create**
5. SendGrid æœƒç™¼é€é©—è­‰éƒµä»¶åˆ° `noreply@hackathon.com.tw`
6. æ‰“é–‹è©²éƒµç®±ï¼Œé»æ“Šé©—è­‰é€£çµ
7. é©—è­‰å®Œæˆï¼

#### é¸é … B - åŸŸåé©—è­‰ï¼ˆæ¨è–¦ï¼Œæ›´å°ˆæ¥­ï¼‰

1. å°èˆªåˆ°ï¼š**Settings** > **Sender Authentication**
2. é»æ“Š **Get Started** (Domain Authentication å€åŸŸ)
3. é¸æ“‡ DNS providerï¼ˆä¾‹å¦‚ï¼šCloudflare, GoDaddy ç­‰ï¼‰
4. è¼¸å…¥åŸŸåï¼š`hackathon.com.tw`
5. SendGrid æœƒç”Ÿæˆ DNS è¨˜éŒ„ï¼ˆCNAMEï¼‰
6. å‰å¾€æ‚¨çš„ DNS ç®¡ç†å¹³å°æ·»åŠ é€™äº›è¨˜éŒ„
7. è¿”å› SendGrid é»æ“Š **Verify**
8. é©—è­‰å®Œæˆå¾Œï¼Œå¯ä½¿ç”¨è©²åŸŸåä¸‹ä»»ä½•éƒµç®±ä½œç‚ºç™¼ä»¶äºº

### Step 4: é…ç½®ç’°å¢ƒè®Šé‡

åœ¨æœå‹™å™¨ä¸ŠåŸ·è¡Œï¼š

```bash
# é€²å…¥å°ˆæ¡ˆç›®éŒ„
cd /home/reyerchu/hack/hack

# ç·¨è¼¯ç’°å¢ƒè®Šé‡æ–‡ä»¶
nano .env.local

# æ·»åŠ ä»¥ä¸‹é…ç½®ï¼ˆæ›¿æ›æˆæ‚¨çš„ API Keyï¼‰ï¼š
SENDGRID_API_KEY=SG.your-actual-api-key-here
EMAIL_FROM=noreply@hackathon.com.tw
NEXT_PUBLIC_BASE_URL=https://hackathon.com.tw
```

æŒ‰ `Ctrl+X`ï¼Œç„¶å¾Œ `Y`ï¼Œå†æŒ‰ `Enter` ä¿å­˜ã€‚

### Step 5: é‡å•Ÿæ‡‰ç”¨

```bash
pm2 restart hackportal
```

æˆ–å¦‚æœä½¿ç”¨ systemdï¼š

```bash
sudo systemctl restart hackportal
```

### Step 6: æ¸¬è©¦éƒµä»¶ç™¼é€

1. è¨ªå•ï¼šhttps://hackathon.com.tw/team-up/create
2. ä½¿ç”¨æ‚¨çš„è³¬è™Ÿç™»å…¥
3. å‰µå»ºä¸€å€‹æ¸¬è©¦ã€Œæ‰¾éšŠå‹ã€éœ€æ±‚
4. æª¢æŸ¥æ‚¨çš„éƒµç®±ï¼ˆè¨»å†Šæ™‚ä½¿ç”¨çš„éƒµç®±ï¼‰
5. æ‡‰è©²æ”¶åˆ°ã€Œæ‰¾éšŠå‹éœ€æ±‚å·²ç™¼å¸ƒæˆåŠŸã€çš„éƒµä»¶

### Step 7: æŸ¥çœ‹æ—¥èªŒï¼ˆæ’æŸ¥å•é¡Œï¼‰

```bash
# æŸ¥çœ‹å¯¦æ™‚æ—¥èªŒ
pm2 logs hackportal --lines 100

# æŸ¥æ‰¾éƒµä»¶ç›¸é—œæ—¥èªŒ
pm2 logs hackportal --lines 1000 | grep -i email

# æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ
pm2 logs hackportal --err --lines 50
```

## ğŸ“§ éƒµä»¶æ¨¡æ¿èªªæ˜

### 1. å‰µå»ºéœ€æ±‚ç¢ºèªéƒµä»¶
- **ä¸»æ—¨**ï¼š`[RWA Hackathon] æ‰¾éšŠå‹éœ€æ±‚å·²ç™¼å¸ƒæˆåŠŸ`
- **æ”¶ä»¶äºº**ï¼šéœ€æ±‚ç™¼å¸ƒè€…
- **å…§å®¹**ï¼šéœ€æ±‚æ‘˜è¦ã€ç®¡ç†é€£çµ

### 2. æ”¶åˆ°ç”³è«‹é€šçŸ¥
- **ä¸»æ—¨**ï¼š`[RWA Hackathon] æ”¶åˆ°æ–°çš„éšŠå‹æ‡‰å¾µ`
- **æ”¶ä»¶äºº**ï¼šéœ€æ±‚ç™¼å¸ƒè€…
- **å…§å®¹**ï¼šç”³è«‹è€…ä¿¡æ¯ã€ç•™è¨€ã€è¯ç¹«æ–¹å¼

### 3. ç”³è«‹æäº¤ç¢ºèª
- **ä¸»æ—¨**ï¼š`[RWA Hackathon] å·²æŠ•éï¼šã€Œéœ€æ±‚æ¨™é¡Œã€`
- **æ”¶ä»¶äºº**ï¼šç”³è«‹è€…
- **å…§å®¹**ï¼šç”³è«‹æ‘˜è¦ã€å¾ŒçºŒæµç¨‹

### 4. ç”³è«‹ç‹€æ…‹æ›´æ–°
- **ä¸»æ—¨ï¼ˆæ¥å—ï¼‰**ï¼š`[RWA Hackathon] å¥½æ¶ˆæ¯ï¼æ‚¨çš„æ‡‰å¾µå·²è¢«æ¥å—`
- **ä¸»æ—¨ï¼ˆæ‹’çµ•ï¼‰**ï¼š`[RWA Hackathon] é—œæ–¼æ‚¨çš„æ‡‰å¾µ`
- **æ”¶ä»¶äºº**ï¼šç”³è«‹è€…
- **å…§å®¹**ï¼šç‹€æ…‹ã€è¯ç¹«ä¿¡æ¯

## ğŸ”§ å¸¸è¦‹å•é¡Œæ’æŸ¥

### å•é¡Œ 1ï¼šé…ç½®å¾Œä»ç„¡æ³•ç™¼é€éƒµä»¶

**æª¢æŸ¥æ¸…å–®**ï¼š
```bash
# 1. ç¢ºèªç’°å¢ƒè®Šé‡å·²åŠ è¼‰
pm2 env 0 | grep SENDGRID

# 2. æŸ¥çœ‹æ‡‰ç”¨æ—¥èªŒ
pm2 logs hackportal --lines 200 | grep -i email

# 3. é‡æ–°åŠ è¼‰ç’°å¢ƒè®Šé‡
pm2 restart hackportal --update-env
```

### å•é¡Œ 2ï¼šAPI Key ç„¡æ•ˆéŒ¯èª¤

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- ç¢ºèª API Key ä»¥ `SG.` é–‹é ­
- ç¢ºèªæ²’æœ‰é¡å¤–çš„ç©ºæ ¼æˆ–æ›è¡Œ
- å˜—è©¦é‡æ–°å‰µå»º API Key
- ç¢ºèª API Key æ¬Šé™åŒ…å« Mail Send

### å•é¡Œ 3ï¼šç™¼ä»¶äººæœªé©—è­‰éŒ¯èª¤

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- å‰å¾€ SendGrid Dashboard > Settings > Sender Authentication
- ç¢ºèªéƒµç®±æˆ–åŸŸåé¡¯ç¤ºç‚º "Verified"
- ç¢ºèª `.env.local` ä¸­çš„ `EMAIL_FROM` èˆ‡é©—è­‰çš„éƒµç®±åŒ¹é…

### å•é¡Œ 4ï¼šéƒµä»¶é€²å…¥åƒåœ¾éƒµä»¶ç®±

**æ”¹å–„æ–¹æ³•**ï¼š
- ä½¿ç”¨åŸŸåé©—è­‰ï¼ˆè€Œéå–®å€‹éƒµç®±é©—è­‰ï¼‰
- è¨­ç½® SPFã€DKIM è¨˜éŒ„ï¼ˆåŸŸåé©—è­‰æ™‚è‡ªå‹•é…ç½®ï¼‰
- åœ¨ SendGrid ä¸­è¨­ç½® Sender Identity
- é¿å…éƒµä»¶å…§å®¹åŒ…å«éå¤šé€£çµ

### å•é¡Œ 5ï¼šæŸ¥çœ‹ SendGrid ç™¼é€ç‹€æ…‹

1. ç™»å…¥ SendGrid Dashboard
2. å·¦å´èœå–®ï¼š**Activity** > **Email Activity**
3. å¯ä»¥çœ‹åˆ°æ‰€æœ‰éƒµä»¶çš„ç™¼é€ç‹€æ…‹
4. é»æ“Šå…·é«”éƒµä»¶æŸ¥çœ‹è©³æƒ…ï¼ˆé€é”ã€æ‰“é–‹ã€é»æ“Šç­‰ï¼‰

## ğŸ“Š ç›£æ§èˆ‡åˆ†æ

### SendGrid Dashboard

è¨ªå• SendGrid Dashboard å¯ä»¥æŸ¥çœ‹ï¼š
- éƒµä»¶ç™¼é€çµ±è¨ˆ
- é€é”ç‡ã€æ‰“é–‹ç‡ã€é»æ“Šç‡
- éŒ¯èª¤å’Œåå½ˆéƒµä»¶
- å¯¦æ™‚éƒµä»¶æ´»å‹•

### æ¨è–¦ç›£æ§æŒ‡æ¨™

- **é€é”ç‡**ï¼šæ‡‰è©² > 95%
- **åå½ˆç‡**ï¼šæ‡‰è©² < 5%
- **åƒåœ¾éƒµä»¶æŠ•è¨´ç‡**ï¼šæ‡‰è©² < 0.1%

## ğŸ” å®‰å…¨å»ºè­°

1. **API Key ä¿è­·**
   - ä¸è¦æäº¤åˆ° Git
   - ä½¿ç”¨ `.env.local`ï¼ˆå·²åœ¨ .gitignore ä¸­ï¼‰
   - å®šæœŸæ›´æ› API Key

2. **è¨ªå•æ§åˆ¶**
   - åªçµ¦éœ€è¦çš„äºº SendGrid è³¬è™Ÿè¨ªå•æ¬Šé™
   - ä½¿ç”¨æœ€å°æ¬Šé™åŸå‰‡

3. **éƒµä»¶å…§å®¹**
   - ä¸è¦åŒ…å«æ•æ„Ÿä¿¡æ¯
   - ä½¿ç”¨ HTTPS é€£çµ
   - åŒ…å«å–æ¶ˆè¨‚é–±é¸é …ï¼ˆå¦‚é©ç”¨ï¼‰

## ğŸ†˜ éœ€è¦å¹«åŠ©ï¼Ÿ

å¦‚æœé…ç½®å¾Œä»æœ‰å•é¡Œï¼Œè«‹æª¢æŸ¥ï¼š

1. **æœå‹™å™¨æ—¥èªŒ**ï¼š
   ```bash
   pm2 logs hackportal --err --lines 100
   ```

2. **SendGrid Dashboard > Email Activity**
   - æŸ¥çœ‹éƒµä»¶ç™¼é€æ­·å²å’ŒéŒ¯èª¤

3. **ç’°å¢ƒè®Šé‡**ï¼š
   ```bash
   cat .env.local | grep SENDGRID
   ```

## ğŸ“š ç›¸é—œè³‡æº

- [SendGrid å®˜æ–¹æ–‡æª”](https://docs.sendgrid.com/)
- [SendGrid API åƒè€ƒ](https://docs.sendgrid.com/api-reference/mail-send/mail-send)
- [éƒµä»¶æœ€ä½³å¯¦è¸](https://docs.sendgrid.com/ui/sending-email/deliverability)

---

**æ³¨æ„**ï¼šå¦‚æœä¸é…ç½® SendGridï¼Œéƒµä»¶åŠŸèƒ½ä¸æœƒå ±éŒ¯ï¼Œåªæ˜¯ä¸æœƒå¯¦éš›ç™¼é€éƒµä»¶ã€‚æ‰€æœ‰å…¶ä»–åŠŸèƒ½ï¼ˆæ‰¾éšŠå‹ã€ç”³è«‹ç­‰ï¼‰ä»ç„¶æ­£å¸¸å·¥ä½œã€‚

