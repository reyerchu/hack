# ğŸ“‹ NFT åˆ—è¡¨åŠŸèƒ½ - ç”¨æˆ¶å€‹äººé é¢

## ğŸ¯ åŠŸèƒ½æè¿°

åœ¨ç”¨æˆ¶å€‹äººé é¢ï¼ˆ`/user/[userId]`ï¼‰ä¸Šé¡¯ç¤º**æ‰€æœ‰ç›¸é—œçš„ NFT æ´»å‹•åˆ—è¡¨**ï¼Œè€Œä¸æ˜¯åªé¡¯ç¤ºå–®ä¸€å€‹ NFT ç‹€æ…‹ã€‚

### æ›´æ–°å‰
- âŒ åªé¡¯ç¤ºä¸€å€‹ NFT æ´»å‹•çš„ç‹€æ…‹ï¼ˆé ‚éƒ¨çš„ [é‘„é€  NFT] æŒ‰éˆ•æˆ– [å·²é‘„é€ ] æ¨™ç±¤ï¼‰
- âŒ ç„¡æ³•æŸ¥çœ‹æ‰€æœ‰ç›¸é—œçš„ NFT æ´»å‹•

### æ›´æ–°å¾Œ
- âœ… é¡¯ç¤ºæ‰€æœ‰ç”¨æˆ¶æœ‰æ¬Šé™çš„ NFT æ´»å‹•åˆ—è¡¨
- âœ… æ¯å€‹ NFT æ´»å‹•é¡¯ç¤ºç‚ºç¨ç«‹çš„å¡ç‰‡
- âœ… æ¯å€‹å¡ç‰‡é¡¯ç¤º NFT åœ–ç‰‡ã€åç¨±ã€æè¿°ã€ç¶²è·¯ã€ä¾›æ‡‰é‡
- âœ… æ ¹æ“šç‹€æ…‹é¡¯ç¤ºä¸åŒçš„æ“ä½œï¼š
  - **å·²é‘„é€ **ï¼šé¡¯ç¤ºç¶ è‰²çš„ [å·²é‘„é€ ] æ¨™ç±¤ï¼ŒåŒ…å« Token ID å’Œäº¤æ˜“é€£çµ
  - **å¯é‘„é€ **ï¼šé¡¯ç¤º [é‘„é€  NFT] æŒ‰éˆ•ï¼ˆç´…è‰²ï¼‰
  - **ä¸å¯é‘„é€ **ï¼šé¡¯ç¤ºåŸå› ï¼ˆå¦‚ï¼šæ´»å‹•çµæŸã€ä¾›æ‡‰é‡å·²æ»¿ã€æœªé–‹å§‹ç­‰ï¼‰

---

## ğŸ“ ä¿®æ”¹çš„æª”æ¡ˆ

### 1. `/lib/nft/check-eligibility.ts`

#### æ–°å¢å‡½æ•¸ï¼š`getAllUserNFTCampaigns`

```typescript
export async function getAllUserNFTCampaigns(email: string): Promise<NFTCampaignStatus[]>
```

**åŠŸèƒ½**ï¼š
- ç²å–ç”¨æˆ¶æ‰€æœ‰ç›¸é—œçš„ NFT æ´»å‹•ï¼ˆç™½åå–®ä¸­çš„æ´»å‹•ï¼‰
- æª¢æŸ¥æ¯å€‹æ´»å‹•çš„é‘„é€ ç‹€æ…‹
- åˆ¤æ–·æ¯å€‹æ´»å‹•çš„å¯ç”¨æ€§ï¼ˆeligibleï¼‰

**è¿”å›**ï¼š
```typescript
interface NFTCampaignStatus {
  campaignId: string;
  name: string;
  description: string;
  imageUrl: string;
  network: string;
  contractAddress: string;
  maxSupply: number;
  currentSupply: number;
  startDate?: Date;
  endDate?: Date;
  eligible: boolean;         // æ˜¯å¦å¯ä»¥é‘„é€ 
  alreadyMinted: boolean;    // æ˜¯å¦å·²é‘„é€ 
  mintRecord?: {             // é‘„é€ è¨˜éŒ„ï¼ˆå¦‚æœå·²é‘„é€ ï¼‰
    mintedAt: Date;
    transactionHash: string;
    tokenId?: number;
  };
  reason?: string;           // ä¸å¯é‘„é€ çš„åŸå› 
}
```

**åˆ¤æ–·é‚è¼¯**ï¼š
1. âœ… `alreadyMinted = true` â†’ `eligible = false`, `reason = "Already minted"`
2. âœ… ä¾›æ‡‰é‡å·²æ»¿ â†’ `eligible = false`, `reason = "Supply exhausted"`
3. âœ… æ´»å‹•æœªé–‹å§‹ â†’ `eligible = false`, `reason = "Campaign not started"`
4. âœ… æ´»å‹•å·²çµæŸ â†’ `eligible = false`, `reason = "Campaign ended"`
5. âœ… å…¶ä»–æƒ…æ³ â†’ `eligible = true`

---

### 2. `/pages/api/user/[userId]/public.ts`

**æ›´æ”¹**ï¼š
```typescript
// æ›´æ–°å‰
const { checkNFTEligibility } = await import('../../../../lib/nft/check-eligibility');
nftMintStatus = await checkNFTEligibility(userEmail);

// æ›´æ–°å¾Œ
const { getAllUserNFTCampaigns } = await import('../../../../lib/nft/check-eligibility');
nftCampaigns = await getAllUserNFTCampaigns(userEmail);
```

**API è¿”å›**ï¼š
```typescript
{
  success: true,
  user: {
    ...publicInfo,
    nftCampaigns: NFTCampaignStatus[]  // è¿”å›åˆ—è¡¨è€Œä¸æ˜¯å–®ä¸€ç‹€æ…‹
  }
}
```

---

### 3. `/pages/user/[userId].tsx`

#### æ›´æ–°çš„ TypeScript é¡å‹

```typescript
interface NFTCampaignInfo {
  campaignId: string;
  name: string;
  description: string;
  imageUrl: string;
  network: string;
  contractAddress: string;
  maxSupply: number;
  currentSupply: number;
  startDate?: Date;
  endDate?: Date;
  eligible: boolean;
  alreadyMinted: boolean;
  mintRecord?: {
    mintedAt: Date;
    transactionHash: string;
    tokenId?: number;
  };
  reason?: string;
}

interface UserPublicInfo {
  // ... å…¶ä»–æ¬„ä½
  nftCampaigns?: NFTCampaignInfo[];  // æ–°å¢
}
```

#### UI æ›´æ”¹

1. **ç§»é™¤**ï¼šé ‚éƒ¨çš„å–®ä¸€ [é‘„é€  NFT] æŒ‰éˆ•å’Œ [å·²é‘„é€ ] æ¨™ç±¤

2. **æ–°å¢**ï¼šNFT åˆ—è¡¨å€å¡Šï¼ˆåœ¨ã€Œåƒèˆ‡çš„åœ˜éšŠã€ä¸‹æ–¹ï¼‰

**å€å¡Šçµæ§‹**ï¼š
```
NFT ç´€å¿µå“
â”œâ”€â”€ NFT å¡ç‰‡ 1
â”‚   â”œâ”€â”€ åœ–ç‰‡ï¼ˆé«˜åº¦ 192pxï¼‰
â”‚   â”œâ”€â”€ æ¨™é¡Œï¼ˆæ´»å‹•åç¨±ï¼‰
â”‚   â”œâ”€â”€ æè¿°
â”‚   â”œâ”€â”€ ç¶²è·¯ & ä¾›æ‡‰é‡è³‡è¨Š
â”‚   â””â”€â”€ ç‹€æ…‹/æ“ä½œ
â”‚       â”œâ”€â”€ [å·²é‘„é€ ] + Token ID + äº¤æ˜“é€£çµï¼ˆç¶ è‰²ï¼‰
â”‚       â”œâ”€â”€ [é‘„é€  NFT] æŒ‰éˆ•ï¼ˆç´…è‰²ï¼‰
â”‚       â””â”€â”€ ä¸å¯é‘„é€ åŸå›  + æˆªæ­¢æ—¥æœŸï¼ˆç°è‰²ï¼‰
â”œâ”€â”€ NFT å¡ç‰‡ 2
â””â”€â”€ ...
```

**è¦–è¦ºè¨­è¨ˆ**ï¼š
- **å·¦é‚Šæ¡†é¡è‰²**ï¼š
  - ç¶ è‰² (`#10b981`) - å·²é‘„é€ 
  - ç´…è‰² (`#8B4049`) - å¯é‘„é€  / ä¸å¯é‘„é€ 
- **å¡ç‰‡ä½ˆå±€**ï¼šGridï¼ˆ1 åˆ— @ æ‰‹æ©Ÿï¼Œ2 åˆ— @ æ¡Œé¢ï¼‰
- **åœ–ç‰‡å®¹å™¨**ï¼šå›ºå®šé«˜åº¦ 192pxï¼Œobject-coverï¼Œå¸¶éŒ¯èª¤è™•ç†

---

## ğŸ¨ UI ç¯„ä¾‹

### å·²é‘„é€ çš„ NFT å¡ç‰‡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [NFT åœ–ç‰‡]                      â”‚ â† ç¶ è‰²å·¦é‚Šæ¡†
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RWA Hackathon Taiwan NFT        â”‚
â”‚ ç¬¬ä¸€å±† RWA é»‘å®¢æ¾å°ç£åƒèˆ‡è­‰æ˜ NFT â”‚
â”‚                                 â”‚
â”‚ [Sepolia] 23 / 100 å·²é‘„é€        â”‚
â”‚                                 â”‚
â”‚ âœ… å·²é‘„é€                        â”‚ â† ç¶ è‰²èƒŒæ™¯
â”‚    Token #1                     â”‚
â”‚ æŸ¥çœ‹äº¤æ˜“è¨˜éŒ„ â†’                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¯é‘„é€ çš„ NFT å¡ç‰‡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [NFT åœ–ç‰‡]                      â”‚ â† ç´…è‰²å·¦é‚Šæ¡†
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Demo Day NFT                    â”‚
â”‚ åƒåŠ  Demo Day çš„ç´€å¿µ NFT        â”‚
â”‚                                 â”‚
â”‚ [Mainnet] 5 / 50 å·²é‘„é€          â”‚
â”‚                                 â”‚
â”‚ [   é‘„é€  NFT   ]                â”‚ â† ç´…è‰²æŒ‰éˆ•
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸å¯é‘„é€ çš„ NFT å¡ç‰‡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [NFT åœ–ç‰‡]                      â”‚ â† ç´…è‰²å·¦é‚Šæ¡†
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Early Bird NFT                  â”‚
â”‚ æ—©é³¥åƒåŠ è€…é™å®š NFT              â”‚
â”‚                                 â”‚
â”‚ [Sepolia] 50 / 50 å·²é‘„é€         â”‚
â”‚                                 â”‚
â”‚ Supply exhausted                â”‚ â† ç°è‰²èƒŒæ™¯
â”‚ æˆªæ­¢æ—¥æœŸï¼š2025/12/31            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— æ•´åˆèªªæ˜

### é‘„é€ æŒ‰éˆ•é€£çµ

```tsx
<Link href={`/nft/mint?campaign=${campaign.campaignId}`}>
```

é»æ“Šã€Œé‘„é€  NFTã€æŒ‰éˆ•æ™‚ï¼Œæœƒå°å‘ `/nft/mint` é é¢ï¼Œä¸¦å¸¶ä¸Š `campaign` åƒæ•¸ï¼Œè®“é‘„é€ é é¢çŸ¥é“è¦é‘„é€ å“ªå€‹æ´»å‹•çš„ NFTã€‚

### äº¤æ˜“è¨˜éŒ„é€£çµ

```tsx
https://{network}.etherscan.io/tx/{transactionHash}
```

æ ¹æ“šç¶²è·¯è‡ªå‹•ç”Ÿæˆæ­£ç¢ºçš„ Etherscan é€£çµï¼š
- **Mainnet**: `https://etherscan.io/tx/...`
- **Sepolia**: `https://sepolia.etherscan.io/tx/...`
- **Arbitrum**: `https://arbiscan.io/tx/...`

---

## ğŸ§ª æ¸¬è©¦

### æ¸¬è©¦å ´æ™¯

1. **ç„¡ NFT æ´»å‹•**
   - ç”¨æˆ¶ä¸åœ¨ä»»ä½•ç™½åå–®ä¸­
   - NFT å€å¡Šä¸é¡¯ç¤º âœ…

2. **æœ‰ 1 å€‹å¯é‘„é€  NFT**
   - é¡¯ç¤º 1 å€‹å¡ç‰‡
   - [é‘„é€  NFT] æŒ‰éˆ•å¯è¦‹ âœ…

3. **æœ‰å¤šå€‹ NFTï¼ˆå·²é‘„é€  + å¯é‘„é€ ï¼‰**
   - é¡¯ç¤ºå¤šå€‹å¡ç‰‡
   - å·²é‘„é€ çš„é¡¯ç¤ºç¶ è‰²æ¨™ç±¤
   - å¯é‘„é€ çš„é¡¯ç¤ºç´…è‰²æŒ‰éˆ• âœ…

4. **æ´»å‹•å·²çµæŸ**
   - é¡¯ç¤ºã€ŒCampaign endedã€
   - é¡¯ç¤ºæˆªæ­¢æ—¥æœŸ âœ…

5. **ä¾›æ‡‰é‡å·²æ»¿**
   - é¡¯ç¤ºã€ŒSupply exhaustedã€âœ…

6. **åªæœ‰æœ¬äººå¯è¦‹**
   - `canEdit = true` æ™‚æ‰é¡¯ç¤º NFT å€å¡Š
   - å…¶ä»–è¨ªå®¢çœ‹ä¸åˆ° NFT åˆ—è¡¨ âœ…

---

## ğŸ“ æ•¸æ“šæµç¨‹

```
ç”¨æˆ¶è¨ªå• /user/abc9e87e1e0e
       â†“
API: /api/user/[userId]/public
       â†“
getAllUserNFTCampaigns(email)
       â†“
æŸ¥è©¢ Firestore:
  1. nft_campaigns (where status = 'active')
  2. æª¢æŸ¥ merkleProofs[email] æ˜¯å¦å­˜åœ¨
  3. æŸ¥è©¢ nft_mints (å·²é‘„é€ è¨˜éŒ„)
       â†“
è¿”å› NFTCampaignStatus[]
       â†“
å‰ç«¯æ¸²æŸ“ NFT å¡ç‰‡åˆ—è¡¨
```

---

## ğŸš€ ä½¿ç”¨èªªæ˜

### ç®¡ç†å“¡å‰µå»º NFT æ´»å‹•

1. è¨ªå•ï¼š`http://localhost:3009/admin/nft/campaigns`
2. é»æ“Šã€Œå»ºç«‹æ–°æ´»å‹•ã€
3. å¡«å¯«æ´»å‹•è³‡è¨Šä¸¦ä¸Šå‚³åœ–ç‰‡
4. æ·»åŠ ç™½åå–® emailï¼ˆç”¨æˆ¶çš„ emailï¼‰
5. é»æ“Šã€Œä¸€éµè‡ªå‹•è¨­ç½®ã€éƒ¨ç½²åˆç´„

### ç”¨æˆ¶æŸ¥çœ‹å’Œé‘„é€ 

1. ç”¨æˆ¶ç™»å…¥ä¸¦è¨ªå•è‡ªå·±çš„å€‹äººé é¢
2. æ»¾å‹•åˆ°ã€ŒNFT ç´€å¿µå“ã€å€å¡Š
3. æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„ NFT æ´»å‹•
4. é»æ“Šã€Œé‘„é€  NFTã€æŒ‰éˆ•é€²å…¥é‘„é€ æµç¨‹

---

## âœ… åŠŸèƒ½å„ªå‹¢

### æ›´å¥½çš„ç”¨æˆ¶é«”é©—
- âœ… ä¸€ç›®äº†ç„¶åœ°æŸ¥çœ‹æ‰€æœ‰ NFT æ´»å‹•
- âœ… æ¸…æ¥šåœ°çŸ¥é“å“ªäº›å·²é‘„é€ ï¼Œå“ªäº›å¯é‘„é€ 
- âœ… é¡¯ç¤ºè©³ç´°çš„ä¸å¯é‘„é€ åŸå› 

### æ›´å¥½çš„è³‡è¨Šå±•ç¤º
- âœ… é¡¯ç¤º NFT åœ–ç‰‡ï¼ˆè¦–è¦ºåŒ–ï¼‰
- âœ… é¡¯ç¤ºç¶²è·¯å’Œä¾›æ‡‰é‡è³‡è¨Š
- âœ… é¡¯ç¤ºæˆªæ­¢æ—¥æœŸï¼ˆæé†’ç”¨æˆ¶ï¼‰

### æ›´éˆæ´»çš„æ“´å±•æ€§
- âœ… æ”¯æŒå¤šå€‹ NFT æ´»å‹•ä¸¦è¡Œ
- âœ… æ¯å€‹æ´»å‹•ç¨ç«‹ç®¡ç†
- âœ… æ˜“æ–¼æ·»åŠ æ–°çš„æ´»å‹•é¡å‹

---

## ğŸ”§ æŠ€è¡“ç´°ç¯€

### æ€§èƒ½è€ƒæ…®

- âœ… ä¸€æ¬¡ API èª¿ç”¨ç²å–æ‰€æœ‰ NFT æ´»å‹•
- âœ… Firestore æŸ¥è©¢å„ªåŒ–ï¼ˆä½¿ç”¨ where æ¢ä»¶ï¼‰
- âœ… åœ–ç‰‡æ‡¶åŠ è¼‰ï¼ˆé»˜èª Next.js Image å„ªåŒ–ï¼‰

### éŒ¯èª¤è™•ç†

- âœ… åœ–ç‰‡åŠ è¼‰å¤±æ•—é¡¯ç¤ºä½”ä½ç¬¦
- âœ… API å¤±æ•—ä¸å½±éŸ¿é é¢å…¶ä»–éƒ¨åˆ†
- âœ… ç©ºç‹€æ…‹è™•ç†ï¼ˆç„¡ NFT æ´»å‹•æ™‚ä¸é¡¯ç¤ºå€å¡Šï¼‰

---

## ğŸ“– ç›¸é—œæ–‡æª”

- `NFT-SYSTEM-COMPLETE.md` - å®Œæ•´çš„ NFT ç³»çµ±æ–‡æª”
- `NFT-IPFS-INTEGRATION.md` - IPFS æ•´åˆèªªæ˜
- `FIX-NFT-IMAGE.md` - NFT åœ–ç‰‡æ•…éšœæ’é™¤

---

**å®Œæˆæ—¥æœŸ**: 2025-11-09  
**ç‰ˆæœ¬**: v4.6  
**åŠŸèƒ½**: ç”¨æˆ¶å€‹äººé é¢ NFT åˆ—è¡¨é¡¯ç¤º

